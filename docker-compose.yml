version: "3.5"

services:
  main:
    restart: unless-stopped
    build:
      context: .
      dockerfile: Dockerfile-main
    network_mode: host
    privileged: true
    tmpfs: /dev/shm:exec
    volumes:
      - /run/udev:/run/udev:ro
      - cam:/var/lib/cam
      - /proc/sysrq-trigger:/sysrq
      - /sys/class/leds/led0/brightness:/sys/class/leds/led0/brightness
      - /sys/class/leds/led1/brightness:/sys/class/leds/led1/brightness
  rtsp:
    restart: unless-stopped
    build:
      context: .
      dockerfile: Dockerfile-rtsp
    #user: nobody
    network_mode: host
    privileged: true
    tmpfs: /dev/shm:exec
    volumes:
      - /run/udev:/run/udev:ro
      - ./rtsp-simple-server.yml:/rtsp-simple-server.yml:ro

volumes:
  cam: